# 整体流程

![数据审计流程](../../assets/ref/data-lifecycle/audit-process.svg)

CESS 为了让存储节点诚实客观公正的服务于客户存储的数据，依赖于特别制定的审计算法和激励机制。其中审计算法包括：存储挑战声明、存储证明生成、和存储证明验证。

# 存储挑战声明

链网络按一定的周期（具体时间随机）随机抽取一定比例的存储节点声明存储挑战任务。挑战的存储内容按数据类型分为“空闲数据”和“客户数据”；而存储挑战的关键参数：factors（挑战因子）用于被设计的存储证明算法的输入，会因数据类型和数据规模的不一样而不尽相同。存储挑战作为任务具有“超时”属性，该时间按每个被“挑战”到的存储节点的数据规模来估算。挑战声明中的“baseline”为挑战声明时的区块号，表示存储节点需要这个区块状态下的存储数据的存储证明。

![存储挑战流程](../../assets/ref/data-lifecycle/challenge-flow.svg)

# 存储证明生成

存储节点收到存储挑战后，需要在指定时间内提交 “存储证明”，否则将会被处罚。存储节点需要提供两类数据的证明：闲置数据证明，用于证明其在链上所声明能提供的存储空间；及服役数据的证明，用于证明其确实正确存储了客户的数据。

![证明生成流程](../../assets/ref/data-lifecycle/proof-flow.svg)

# 存储证明验证

当链网络收到了存储节点提交的 “存储证明”，链会分配 TEE 矿工来验证证明的正确性。CESS 的存储证明是可以公开验证的，任何外部的计算资源都能验证任一存储证明；但是 CESS 在安全和效率的之间做了权衡：使用 TEE 来做验证。TEE 矿工角色目前在 CESS 网络有着重要的角色，在存储证明算法中起到关键作用。存储证明算法中的两个输出参数: `mu` 和 `sigma`。它们被设计为不在链上存放，而是存放在存储节点本地，因此在验证环节需要找存储节点取回。这种设计是考虑到此两个参数的大小 —— 避免将大的数据存在链上。验证结果将用于矿工奖励 / 惩罚上。

![证明验证流程](../../assets/ref/data-lifecycle/verification-flow.svg)
